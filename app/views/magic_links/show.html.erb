<div>
  <% if @magic_link %>
    <h1 class="mb-2 text-xl">Complete your sign up</h1>
    <p class="mb-2">
      Just one more question... what would you like to be called?
    </p>
    <%= form_with model: @human, class: "space-y-4" do |f| %>
      <% if @human.errors.any? %>
        <div class="mb-4">
          <% @human.errors.full_messages.each do |error| %>
            <div class="text-red-600"><%= error %></div>
          <% end %>
        </div>
      <% end %>

      <div>
        <%= f.text_field :handle, placeholder: "Your handle", class: "text-field" %>
      </div>

      <div class="border-t pt-4 mt-4">
        <h2 class="text-lg mb-2">Optional: Set a password</h2>

        <p class="text-sm text-gray-600 mb-3">
          You can sign in with magic links or a password. Setting a password is
          optional.
        </p>

        <div class="space-y-3">
          <div>
            <%= f.label :password, "Password (optional)", class: "block text-sm font-medium text-gray-700 mb-1" %>
            <%= f.password_field :password, placeholder: "At least 12 characters", class: "text-field", autocomplete: "new-password" %>
          </div>

          <div>
            <%= f.label :password_confirmation, "Confirm password", class: "block text-sm font-medium text-gray-700 mb-1" %>
            <%= f.password_field :password_confirmation, class: "text-field", autocomplete: "new-password" %>
          </div>
        </div>
      </div>

      <%= hidden_field_tag "human[magic_link_token]", @magic_link.token %>
      <%= f.submit "Go", class: "rounded-button" %>
    <% end %>
  <% else %>
    <p>Hmm, that magic link does not seem to be valid.</p>
    <p>Perhaps it has expired.</p>
    <p><%= link_to "Try again?", root_path %></p>
  <% end %>
</div>
