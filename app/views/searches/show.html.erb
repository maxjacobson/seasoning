<%= content_for :title do %>
  Search
<% end %>

<div class="bg-white rounded-lg shadow-md p-6 max-w-4xl mx-auto">
  <h1 class="text-2xl font-bold text-gray-900 mb-6">Search results</h1>

  <% if @results.any? %>
    <div class="space-y-4">
      <% @results.each do |result| %>
        <% if result.already_imported_show %>
          <% my_show_count = result.already_imported_show.watchers_count %>
          <%= link_to show_path(result.already_imported_show.slug), data: { test_id: "imported-show-#{result.id}" }, class: "block no-underline" do %>
            <div
              class="
                rounded-md border border-gray-200 p-4 hover:border-gray-400
                hover:bg-orange-50 transition-colors cursor-pointer
              "
            >
              <div class="flex items-start gap-4">
                <div class="flex-shrink-0">
                  <%= image_tag result.poster_url, class: "w-16 h-auto rounded shadow-sm" %>
                </div>

                <div class="flex-1 min-w-0">
                  <div class="font-medium text-gray-900">
                    <%= result.name %>
                    <% if result.year %>
                      <span class="text-gray-500">(<%= result.year %>)</span>
                    <% end %>
                  </div>
                  <div class="text-sm text-gray-500 mt-1">
                    Added by <%= pluralize(my_show_count, "person", "people") %>
                  </div>
                </div>

                <div class="text-gray-400 mt-1">
                  â†’
                </div>
              </div>
            </div>
          <% end %>
        <% else %>
          <%= button_to importable_shows_path, params: { id: result.id }, method: :post, class: "block w-full text-left border-0 bg-transparent p-0", data: { test_id: "import-show-#{result.id}" } do %>
            <div
              class="
                rounded-md border border-gray-200 p-4 hover:border-gray-400
                hover:bg-orange-50 transition-colors cursor-pointer
              "
            >
              <div class="flex items-center gap-4">
                <div class="flex-shrink-0">
                  <%= image_tag result.poster_url, class: "w-16 h-auto rounded shadow-sm" %>
                </div>

                <div class="flex-1">
                  <div class="font-medium text-gray-900">
                    <%= result.name %>
                    <% if result.year %>
                      <span class="text-gray-500">(<%= result.year %>)</span>
                    <% end %>
                  </div>
                </div>

                <div class="text-gray-400">
                  +
                </div>
              </div>
            </div>
          <% end %>
        <% end %>
      <% end %>
    </div>
  <% else %>
    <p class="text-gray-600">No results. Try searching something else.</p>
  <% end %>
</div>
